<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="utf-8">
    <title>{{ profile_username }} 的主页 - MyMiniReddit</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-slate-100 min-h-screen">

    <div class="max-w-4xl mx-auto p-6">

        <div class="flex justify-between items-center mb-6">
            <a href="/" class="text-slate-400 text-sm">&larr; 返回首页</a>

            <div class="space-x-3 text-sm">
            {% if username %}
                <span class="opacity-80">当前登录：{{ username }}</span>

                <a href="/notifications"
                class="px-3 py-1 bg-slate-800 rounded">
                通知
                {% if unread_count and unread_count > 0 %}
                    <span class="ml-1 text-xs text-emerald-400">
                    ({{ unread_count }})
                    </span>
                {% endif %}
                </a>

                <a href="/settings"
                class="px-3 py-1 bg-slate-800 rounded">
                设置
                </a>
                <a href="/logout"
                class="px-3 py-1 bg-slate-700 rounded">
                退出
                </a>
            {% else %}
                <a href="/login"
                class="px-3 py-1 bg-sky-500 rounded font-semibold">
                登录
                </a>
                <a href="/register"
                class="px-3 py-1 bg-emerald-500 rounded font-semibold">
                注册
                </a>
            {% endif %}
            </div>
        </div>

    </div>

    <!-- 基本信息 -->
    <section class="mb-8 max-w-4xl mx-auto p-6 pt-0">
        <h1 class="text-2xl font-bold mb-2">{{ profile_username }} 的主页</h1>
        <div class="bg-slate-800/80 rounded-xl p-4 text-sm space-y-2">
            <p>
                <span class="text-slate-400">用户ID：</span>{{ profile_user_id }}
            </p>
            <p>
                <span class="text-slate-400">角色：</span>
                {% if profile_is_admin %}
                    <span class="text-amber-300">管理员</span>
                {% else %}
                    普通用户
                {% endif %}
            </p>
            <p>
                <span class="text-slate-400">状态：</span>
                {% if profile_is_banned %}
                    <span class="text-red-400">已被封禁</span>
                {% else %}
                    <span class="text-emerald-400">正常</span>
                {% endif %}
            </p>
        </div>
    </section>

    <!-- TA 发的帖子 -->
    <section class="max-w-4xl mx-auto p-6 pt-0">
        <h2 class="text-lg font-semibold mb-3">TA 的帖子</h2>

        <div class="space-y-4">
            {% if posts %}
                {% for p in posts %}
                    <!-- p: (id, title, content, created_at, topic_name, likes) -->
                    <div class="bg-slate-800/80 rounded-xl p-4 hover:bg-slate-700 transition">
                        <div class="flex justify-between items-center mb-1">
                            <a href="/post/{{ p[0] }}"
                               class="text-xl font-semibold hover:underline">
                                {{ p[1] }}
                            </a>
                            <div class="flex items-center gap-2 text-xs text-slate-400">
                                {% if p[4] %}
                                    <span class="text-emerald-300 mr-1">[{{ p[4] }}]</span>
                                {% endif %}
                                {{ p[3].strftime('%Y-%m-%d %H:%M') if p[3] else '' }}
                            </div>
                        </div>

                        <div class="flex justify-between items-center mb-1 text-xs text-slate-400">
                            <div>❤ {{ p[5] }}</div>
                        </div>

                        <p class="text-sm opacity-80 line-clamp-2">
                            {{ p[2][:160] }}{% if p[2]|length > 160 %}...{% endif %}
                        </p>
                    </div>
                {% endfor %}
            {% else %}
                <div class="text-center text-slate-400 py-6">
                    TA 还没有发过帖子。
                </div>
            {% endif %}
        </div>
    </section>

</body>
</html>